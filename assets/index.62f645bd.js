import{V as ke,f as xe}from"./index.a8747fa9.js";import{P as Be,_ as we}from"./index.vue_vue_type_script_setup_true_lang.e793fdb4.js";import{f as De,a as Ue,b as be}from"./part.2e531779.js";import{f as Me}from"./technologyType.d48a90bb.js";import{A as Ve,r as m,C as S,D as Ae,x as Pe,d as p,o as n,c as g,l as r,e as u,f as l,m as y,k as f,g as K,I,J as $,H as E,E as Se,n as o,y as k,q as Ie,s as $e,_ as Le}from"./index.2e5bc0a8.js";const He=M=>(Ie("data-v-10486a36"),M=M(),$e(),M),Ne={class:"app-container"},Re={class:"drawingBox"},Te={class:"leftHandleBox"},ze={key:0},je={class:"tag-list"},qe={class:"percentage-value"},Ge=He(()=>r("span",{class:"percentage-label"},"\u5DF2\u7F16\u8F91\u96F6\u4EF6\u5360\u6BD4",-1)),Je={key:0,class:"pdfBox"},Oe={key:0,class:"handleMethods"},We={key:0,class:"handleBox"},Ke={class:"files-contain"},Qe={class:"file-box"},Xe={class:"dialog-footer"},Ye={class:"dialog-footer"},Ze=Ve({__name:"index",setup(M){const h=m(!1),w=S({depId:""}),L=m(null),Q=()=>{L.value.click()},H=m(null),X=()=>{H.value.click()},Y=t=>{console.log(t);const e=t.target.files[0];C.name=e.name,C.size=e.size,C.type=e.type,C.lastModified=e.lastModified,N=e},Z=t=>{console.log(t);const e=t.target.files[0];v.drawingUrl=e};let N=null;const C=S({name:"",size:"",type:"",lastModified:""}),R=m(null),ee=()=>{R.value.click()},D=m([]),A=[],le=t=>{console.log(t);const e=t.target.files;for(let c=0;c<e.length;c++){const i=e[c];A.push(i),D.value.push({name:i.name,size:i.size,type:i.type,lastModified:i.lastModified})}},te=t=>{const e=D.value.findIndex(c=>c.name===t);D.value.splice(e,1),A.splice(e,1)},F=m(!1),ue=async()=>{const t=new FormData;t.append("projectCode",w.depId),t.append("projectName",w.depId),t.append("file",N),A.forEach(d=>{t.append("files",d)}),F.value=!0;const e=await Ue(t),{data:c,msg:i}=e;_.value=c==null?void 0:c.map(d=>({...d,isSave:!1})),s.value=_.value[0],E.success("\u96F6\u4EF6\u5BFC\u5165\u6210\u529F"),h.value=!1,F.value=!1},ae=async()=>{F.value=!0;let t="";if(v.radio==="local"){const e=new FormData;e.append("file",v.drawingUrl),t=(await xe(e)).data}await be({id:s.value.id,drawingUrl:t}),E.success("\u96F6\u4EF6\u56FE\u7EB8\u66F4\u65B0\u6210\u529F"),U.value=!1,F.value=!1,s.value.drawingUrl=t},_=m([]),s=m(null),ne=async()=>{const t=await De({id:s.value.id,processMethod:s.value.processMethod,external:s.value.external}),{data:e,msg:c}=t;if(e===0){E.success("\u96F6\u4EF6\u4FDD\u5B58\u6210\u529F"),s.value.isSave=!0;return}E.error(c)},T=t=>{const e=_.value.findIndex(c=>c.code===s.value.code);if(t==="prev"){if(e===0){E.warning("\u5DF2\u7ECF\u662F\u7B2C\u4E00\u9879\u4E86");return}s.value=_.value[e-1],E.success("\u5207\u6362\u6210\u529F")}if(t==="next"){if(e===_.value.length-1){E.warning("\u5DF2\u7ECF\u662F\u6700\u540E\u4E00\u9879\u4E86");return}s.value=_.value[e+1],E.success("\u5207\u6362\u6210\u529F")}},oe=t=>{s.value.processMethod=t},se=t=>{s.value=t},de=()=>{if(s.value.external===0){s.value.external=1;return}s.value.external=0},U=m(!1),v=S({radio:"local",drawingUrl:""}),re=()=>{U.value=!0},z=m([]),ce=()=>{Me({processMethod:"",state:Be.ALL,depId:"",createBy:""}).then(t=>{console.log(t),z.value=t.data})};Ae(()=>{ce()});const ie=()=>{var t;((t=_==null?void 0:_.value)==null?void 0:t.length)>0?Se.confirm("\u5F53\u524D\u5B58\u5728\u5DF2\u5BFC\u5165\u7684\u96F6\u4EF6\u5217\u8868\uFF0C\u7EE7\u7EED\u64CD\u4F5C\u4F1A\u8986\u76D6\u5F53\u524D\u96F6\u4EF6\u5217\u8868\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F","Warning",{confirmButtonText:"\u7EE7\u7EED",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{h.value=!0}).catch(()=>{h.value=!1}):h.value=!0},pe=Pe(()=>{var e,c,i,d;if(((e=_.value)==null?void 0:e.length)===0)return 0;const t=(i=(c=_.value)==null?void 0:c.filter(b=>b.isSave))==null?void 0:i.length;return Math.round(t/((d=_.value)==null?void 0:d.length)*1e3)/10}),fe=t=>{var e;if(t.isSave)return"success";if(((e=s.value)==null?void 0:e.code)===t.code)return"warning"};return(t,e)=>{var J,O,W;const c=p("UploadFilled"),i=p("el-icon"),d=p("el-button"),b=p("CircleClose"),x=p("el-tag"),P=p("CircleCheck"),_e=p("el-card"),ve=p("el-timeline-item"),me=p("el-timeline"),Fe=p("el-progress"),ge=p("el-empty"),B=p("el-form-item"),ye=p("CircleCloseFilled"),j=p("el-form"),q=p("el-dialog"),G=p("el-radio"),Ee=p("el-radio-group"),he=p("el-input");return n(),g("div",Ne,[r("div",Re,[r("div",Te,[u(d,{type:"primary",onClick:ie,style:{"margin-bottom":"20px"}},{default:l(()=>[o("\u5BFC\u5165\u56FE\u7EB8\xA0"),u(i,null,{default:l(()=>[u(c)]),_:1})]),_:1}),((J=_.value)==null?void 0:J.length)>0?(n(),g("div",ze,[u(me,{style:{"max-height":"60vh",overflow:"auto"}},{default:l(()=>[(n(!0),g(I,null,$(_.value,(a,V)=>(n(),f(ve,{key:a.code,timestamp:a.code+a.partName,placement:"top",type:fe(a)},{default:l(()=>[u(_e,{onClick:Ce=>se(a),style:{cursor:"pointer"}},{default:l(()=>[r("div",je,[r("span",null,[a.processMethod?(n(),f(x,{key:1,class:"ml-2",type:"success"},{default:l(()=>[o(k(a==null?void 0:a.processMethod)+" ",1),u(i,null,{default:l(()=>[u(P)]),_:1})]),_:2},1024)):(n(),f(x,{key:0,class:"ml-2",type:"danger"},{default:l(()=>[o("\u5904\u7406\u65B9\u6CD5 "),u(i,null,{default:l(()=>[u(b)]),_:1})]),_:1}))]),r("span",null,[a.external?(n(),f(x,{key:1,class:"ml-2",type:"success"},{default:l(()=>[o("\u5185\u90E8\u52A0\u5DE5 "),u(i,null,{default:l(()=>[u(P)]),_:1})]),_:1})):(n(),f(x,{key:0,class:"ml-2",type:"warning"},{default:l(()=>[o("\u5916\u534F\u52A0\u5DE5 "),u(i,null,{default:l(()=>[u(b)]),_:1})]),_:1}))]),r("span",null,[a.isSave?(n(),f(x,{key:0,class:"ml-2",type:"success"},{default:l(()=>[o("\u5DF2\u7F16\u8F91 "),u(i,null,{default:l(()=>[u(P)]),_:1})]),_:1})):(n(),f(x,{key:1,class:"ml-2",type:"danger"},{default:l(()=>[o("\u6682\u672A\u4FDD\u5B58 "),u(i,null,{default:l(()=>[u(b)]),_:1})]),_:1}))])])]),_:2},1032,["onClick"])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])):y("",!0),(O=_.value)!=null&&O.length?(n(),f(Fe,{key:1,type:"circle",percentage:K(pe)},{default:l(({percentage:a})=>[r("span",qe,k(a)+"%",1),Ge]),_:1},8,["percentage"])):y("",!0)]),s.value?(n(),g("div",Je,[u(K(ke),{style:{height:"65vh"},config:{toolbar:!1},"page-scale":"page-width",pdf:"https://p1-kp.adkwai.com/kos/nlav111397/chrome-plugin-upload/2023-10-12/1697113209018.ec7d8f0fc45bc98d.pdf"}),r("div",{class:"handlePartDrawingUrl",onClick:re},[u(d,{class:"handleBtn",type:"warning"},{default:l(()=>[o(" \u4FEE\u6539\u56FE\u7EB8 ")]),_:1})]),r("div",{class:"handleExternal",onClick:de},[s.value.external?(n(),f(d,{key:1,class:"handleBtn",type:"success"},{default:l(()=>[o(" \u5185\u90E8\u52A0\u5DE5 ")]),_:1})):(n(),f(d,{key:0,class:"handleBtn",type:"danger"},{default:l(()=>[o(" \u5916\u534F\u52A0\u5DE5 ")]),_:1}))]),s.value?(n(),g("div",Oe,[(n(!0),g(I,null,$(z.value,a=>(n(),f(d,{class:"handleBtn",type:s.value.processMethod===a.processMethod?"success":"danger",onClick:V=>oe(a.processMethod)},{default:l(()=>[o(k(a.processMethod),1)]),_:2},1032,["type","onClick"]))),256))])):y("",!0)])):(n(),f(ge,{key:1,description:"\u70B9\u51FB\u5DE6\u4FA7\u6309\u94AE\u5BFC\u5165\u56FE\u7EB8"}))]),r("div",null,[(W=_.value)!=null&&W.length?(n(),g("div",We,[s.value?(n(),f(d,{key:0,onClick:e[0]||(e[0]=a=>T("prev"))},{default:l(()=>[o("\u4E0A\u4E00\u9879")]),_:1})):y("",!0),s.value?(n(),f(d,{key:1,type:"primary",onClick:ne},{default:l(()=>[o("\u66F4\u65B0\u5F53\u524D\u96F6\u4EF6")]),_:1})):y("",!0),s.value?(n(),f(d,{key:2,onClick:e[1]||(e[1]=a=>T("next"))},{default:l(()=>[o("\u4E0B\u4E00\u9879")]),_:1})):y("",!0)])):y("",!0)]),u(q,{title:"\u5BFC\u5165\u56FE\u7EB8",modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=a=>h.value=a),width:"30%","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{footer:l(()=>[r("div",Xe,[u(d,{type:"primary",onClick:ue,loading:F.value},{default:l(()=>[o("\u5BFC \u5165")]),_:1},8,["loading"]),u(d,{onClick:e[3]||(e[3]=a=>h.value=!1),disabled:F.value},{default:l(()=>[o("\u53D6 \u6D88")]),_:1},8,["disabled"])])]),default:l(()=>[u(j,{model:w,"label-width":"90px"},{default:l(()=>[u(B,{label:"\u9879\u76EE\u540D\u79F0"},{default:l(()=>[u(we,{modelValue:w.depId,"onUpdate:modelValue":e[2]||(e[2]=a=>w.depId=a),style:{width:"240px"}},null,8,["modelValue"])]),_:1}),u(B,{label:"\u56FE\u7EB8"},{default:l(()=>[r("div",null,[u(d,{type:"primary",onClick:Q},{default:l(()=>[o(" \u9009\u62E9\u6587\u4EF6 ")]),_:1}),r("input",{ref_key:"excelRef",ref:L,style:{display:"none"},name:"file",accept:".xls,.xlsx",type:"file",onChange:Y},null,544)]),r("div",null," \xA0\xA0"+k(C==null?void 0:C.name),1)]),_:1}),u(B,{label:"\u96F6\u4EF6\u6587\u4EF6\u5939"},{default:l(()=>{var a;return[r("div",null,[u(d,{type:"warning",onClick:ee},{default:l(()=>[o(" \u9009\u62E9\u56FE\u7EB8\u6587\u4EF6 ")]),_:1}),r("input",{ref_key:"pdfRef",ref:R,style:{display:"none"},name:"file",multiple:"",accept:".pdf,.png",type:"file",onChange:le},null,544),o(" "+k(((a=D.value)==null?void 0:a.length)+"\u4E2A\u96F6\u4EF6\u6587\u4EF6"),1)]),r("div",Ke,[(n(!0),g(I,null,$(D.value,V=>(n(),g("div",Qe,[o(k(V.name)+"\xA0\xA0",1),u(i,{onClick:Ce=>te(V.name),style:{cursor:"pointer"}},{default:l(()=>[u(ye)]),_:2},1032,["onClick"])]))),256))])]}),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),u(q,{title:"\u5BFC\u5165\u56FE\u7EB8",modelValue:U.value,"onUpdate:modelValue":e[9]||(e[9]=a=>U.value=a),width:"30%","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{footer:l(()=>[r("div",Ye,[u(d,{type:"primary",onClick:ae,loading:F.value},{default:l(()=>[o("\u66F4 \u6539")]),_:1},8,["loading"]),u(d,{onClick:e[8]||(e[8]=a=>U.value=!1),disabled:F.value,loading:F.value},{default:l(()=>[o("\u53D6 \u6D88")]),_:1},8,["disabled","loading"])])]),default:l(()=>[u(j,{model:v,"label-width":"90px"},{default:l(()=>[u(B,{label:""},{default:l(()=>[u(Ee,{modelValue:v.radio,"onUpdate:modelValue":e[5]||(e[5]=a=>v.radio=a),onChange:e[6]||(e[6]=a=>v.drawingUrl=void 0)},{default:l(()=>[u(G,{label:"local"},{default:l(()=>[o("\u672C\u5730\u6587\u4EF6")]),_:1}),u(G,{label:"network"},{default:l(()=>[o("\u7F51\u7EDC\u5730\u5740")]),_:1})]),_:1},8,["modelValue"])]),_:1}),v.radio==="local"?(n(),f(B,{key:0,label:"\u56FE\u7EB8"},{default:l(()=>{var a;return[r("div",null,[u(d,{type:"primary",onClick:X},{default:l(()=>[o(" \u9009\u62E9\u6587\u4EF6 ")]),_:1}),r("input",{ref_key:"drawingUrlRef",ref:H,style:{display:"none"},name:"file",accept:".pdf,.png",type:"file",onChange:Z},null,544)]),r("div",null," \xA0\xA0"+k((a=v==null?void 0:v.drawingUrl)==null?void 0:a.name),1)]}),_:1})):y("",!0),v.radio==="network"?(n(),f(B,{key:1,label:"\u56FE\u7EB8\u5730\u5740"},{default:l(()=>[u(he,{modelValue:v.drawingUrl,"onUpdate:modelValue":e[7]||(e[7]=a=>v.drawingUrl=a),placeholder:"\u8BF7\u8F93\u5165\u7F51\u7EDC\u5730\u5740"},null,8,["modelValue"])]),_:1})):y("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const nl=Le(Ze,[["__scopeId","data-v-10486a36"]]);export{nl as default};
